{% extends "base.html" %}

{% block js %}
<script src="/static/js/player.js"></script>
<script type="text/javascript">

    var playingTable = $("#play-list").DataTable({

        "autoWidth" : false,
        "processing": true,
        "serverSide": true,
        "iDisplayLength" : 50,
        "responsive": true,
        "ajax": '/playlist/playinglist/',
        "columns": [
            { "searchable": true},
            { "searchable": false }
          ],
        "searchCols": [
            {"search": "name"}
        ]
    });

    function deleteFromPlaylist(song_id) {
        $.post("/playlist/delete/", {song_id: song_id}, function() {
            playingTable.refresh();
        })
    }
    function addToPlaylist(song_id) {
        var data = {
            song_id: song_id,
            playlist_id: 1
        }
        $.post("/playlist/add/", data, function(response) {

        });
    }
</script>
{% endblock %}

{% block content %}
<div id="player-wrapper">
    <h1 class="song-title">Not Playing <em></em></h1>

    <input id="current-song" type="hidden" value="{{playlist.current_song.to_json}}">

    <div class="audiojs" classname="audiojs" id="audiojs_wrapper0">
        <audio></audio>
        <div class="play-pause">
            <p class="play"></p>
            <p class="pause"></p>
            <p class="loading"></p>
            <p class="error"></p>
        </div>
        <div class="scrubber">
            <div class="progress" style="width: 100%;"></div>
            <div class="loaded" style="width: 100%;"></div>
        </div>
        <div class="time">
            <em class="played">00:00</em>/<strong class="duration">00:00</strong>
        </div>
        <div class="error-message"></div>
    </div>
</div>

<br>
<button class="btn btn-primary" onclick="player.play()"><i class="fa fa-play"></i> Play</button>
<button class="btn btn-warning" onclick="player.pause()"><i class="fa fa-pause"></i> Pause</button>
<button class="btn btn-danger" onclick="player.stop()"><i class="fa fa-stop"></i> Stop</button>
<button class="btn btn-success" onclick="player.next()"><i class="fa fa-next"></i> Next</button>
<button class="btn btn-success" onclick="player.previous()"><i class="fa fa-previous"></i> Previous</button>

<div style="margin-top: 20px;" class="panel panel-default">
    <div class="panel-heading panel-toggler">
        <i class="fa fa-list"></i> PlayingList
    </div>

    <div class="panel-body">
        <div>
            <table class="table table-striped table-bordered table-hover" id="play-list">
                <thead>
                    <tr>
                        <th>Song</th>
                        <th>Action</th>
                    </tr>
                </thead>
            </table>
        </div>
    </div>
</div>
{% endblock %}
